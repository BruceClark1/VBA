'This function retrieves a formula from a VLOOKUP result and evaluates the formula at point of inception.
Public Function ExecuteVLookUpFormula(lookup_value As Range, table_array As Range, col_index_num As Integer, Optional range_lookup As Boolean)
    Dim strFormula As String
    
    On Error GoTo ErrorHandler
    
    'Gets the R1C1 formula of the VLOOKUP result.
    strFormula = Application.WorksheetFunction.vlookup(lookup_value, table_array.FormulaR1C1, col_index_num, range_lookup)
   
    'Evaluates the R1C1 formula as a standard formula and returns the result.
    ExecuteVLookUpFormula = Evaluate(Application.ConvertFormula(strFormula, xlR1C1, xlA1))
    
    Exit Function
   
ErrorHandler:
    If Err.Number <> 0 Then
     Msg = "Error # " & Str(Err.Number) & " was generated by " _
         & Err.Source & Chr(13) & "Error Line: " & Erl & Chr(13) & Err.Description
     MsgBox Msg, , "Error", Err.HelpFile, Err.HelpContext
    End If
   
End Function
